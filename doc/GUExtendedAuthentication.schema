# GUExtendedAuthentication
#
# 1.3.6.1.4.1.36215 is the toplevel OID for this work
#           .1 = GUNet Identity related work
#           .1.1 = GUPerson
#           .1.2 = GUStudent
#           etc.
#
#           .100 = GUnet authentication prefix
#           .100.1 = GUExtendedAuthentication
#           .100.1.3.1 = attributes
#           .100.1.3.2 = objectclass
#
# CHANGELOG
#
#
# * 24-Oct-2012 (avel@noc.uoa.gr)
#    * added OTP-related attributes
#
# *  June 2012 (avel@noc.uoa.gr)
#      * changed OID because of clashes
#      * added GUaCtp
#
# * Nov-2011 (avel@noc.uoa.gr)
#      * added password-related accounts GUAccountSecondaryOpenID GUAccountSecondaryMail GUAccountSecondaryOptOut
#
# * 17-Oct-2011 (avel@noc.uoa.gr) Initial version
#
# $Id$

# ======================= Attributes ======================= 

# Blatantly copied over from samba schema 3.0
attributetype ( 1.3.6.1.4.1.7165.2.1.25 NAME 'sambaNTPassword'
        DESC 'MD4 hash of the unicode password'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{32} SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.1
        NAME 'GUDigestHA1'
        DESC 'MD5 hash of the uid:realm:password string'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{32} SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.2
        NAME 'GUAccountSecondaryOpenID'
        DESC 'Secondary Accounts used for password reset or other purposes'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{256} )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.3
        NAME 'GUAccountSecondaryMail'
        DESC 'Secondary E-mail Addresses used for password reset or other purposes'
        EQUALITY caseIgnoreIA5Match
        SUBSTR caseIgnoreIA5SubstringsMatch
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{256} )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.4
      NAME 'GUAccountSecondaryOptOut'
      DESC 'If exists and is TRUE, user has elected not to be bothered again about entering secondary account information used for password reset or other purposes'
      EQUALITY booleanMatch
      SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
      SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.5
        NAME 'GUCtp'
        DESC 'Symmetric CTP'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{256} )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.6
        NAME 'GUaCtp'
        DESC 'Assymetric CTP'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{256} )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.7
        NAME 'GUOTPInitKey'
        DESC 'Base-32-encoded Initialization Key for Time-Based One Time Password, for additional security'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{32} SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.36215.100.1.3.1.8
        NAME 'GUOTPBackupPasswords'
        DESC 'Backup Password(s) for when Time-Based OTP password is set'
        EQUALITY caseIgnoreIA5Match
        SYNTAX 1.3.6.1.4.1.1466.115.121.1.26{32})

# ======================= Objectclass ======================= 

objectclass ( 1.3.6.1.4.1.36215.100.1.3.2 NAME 'GUExtendedAuthentication' SUP top AUXILIARY
        DESC 'Enables extended authentication attributes such as smb password on any objects'
        MAY  ( sambaNTPassword $ GUDigestHA1 $ GUAccountSecondaryOpenID $ GUAccountSecondaryMail $
               GUAccountSecondaryOptOut $ GUCtp $ GUaCtp $ GUOTPInitKey $ GUOTPBackupPasswords ))
